{
  "hash": "668bdb56597e1990656f5531010ca5db",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Histogram with auto binning in ggplot2\"\ndate: \"24 May 2018\"\ndate-modified: \"24 February 2024\"\ncategories:\n  - R tips\n  - ggplot2\n  - base R\nauthor: Gary Hutson\nsubtitle: >\n  \"Building the Histogram with auto binning\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 20240224 Added for qmd to run\nlibrary(ggplot2)\ntheme_set(theme_classic())\ndata(\"mtcars\") # load data\n\nmtcars$CarBrand <- rownames(mtcars) # Create new column for car brands and names\n\nmtcars$mpg_z_score <- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), digits=2)\n\nmtcars$mpg_type <- ifelse(mtcars$mpg_z_score <= 0, \"below\", \"above\")\n\nmtcars <- mtcars[order(mtcars$mpg_z_score), ] #Ascending sort on Z Score\nmtcars$CarBrand <- factor(mtcars$CarBrand, levels = mtcars$CarBrand)\n```\n:::\n\n\n# Histograms (with auto binning)\n\nAgain, we will use the `mtcars` dataset and use the fields in that to produce the chart, as we are doing this there is nothing to do on the data preparation side. That leaves us to have fun with the plot.\n\nBuilding the Histogram with auto binning\n\nI set up the plot, as per below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ntheme_set(theme_classic())\n```\n:::\n\n\nI import the `ggplot2` library and set my chart theme to a classic theme. The process next is to create the histogram plot and feed in the relevant data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot <- ggplot(mpg, aes(displ)) + scale_fill_brewer(palette = \"Blues\")\n```\n:::\n\n\nI create a plot placeholder in memory so I can reuse this plot again and again in memory. This sets the aes layer equal to the displacement metric in the `mtcars` data frame. I then use the `scale_fill_brewer` command and select the palette to the Blues palette. A list of palettes can be found on the [R Graph Gallery](https://r-graph-gallery.com/38-rcolorbrewers-palettes.html).\n\n<!-- The original link http://bxhorn.com/rcolorbrewer-palettes/ redirects to the generic site -->\n\nThe next section uses the [`geom_histogram()`](https://www.rdocumentation.org/packages/ggplot2/versions/0.9.1/topics/geom_histogram) geometry to force this to be a histogram:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot + geom_histogram(aes(fill=class),\n                      binwidth = .1,\n                      col=\"black\",\n                      size=.1) +\n  labs(title=\"Histogram with Auto Binning\",\n       caption=\"Produced by Gary Hutson\") + xlab(\"Displacement\")\n```\n:::\n\n\nThe histogram uses the class of vehicle as the histogram fill, the binwidth is the width of the bins required, the colour is equal to black and the size is stipulated here. All that I then do is add the data labels to it and you have a lovely looking histogram built. This can be applied to any dataset. The output is as below:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](histogram-with-auto-binning-in-ggplot2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n# Specifying binning values\n\nThe script can be simply changed in the histogram layer by adding the `bins` parameter:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot + geom_histogram(aes(fill=class),\n                   bins=5,\n                   col=\"black\",\n                   size=.1) +\n  labs(title=\"Histogram with Auto Binning\",\n       caption=\"Produced by Gary Hutson\") + xlab(\"Displacement\")\n```\n\n::: {.cell-output-display}\n![](histogram-with-auto-binning-in-ggplot2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThis blog was written by Gary Hutson, Principal Analyst, Activity & Access Team, Information & Insight at Nottingham University Hospitals NHS Trust, and was originally posted on [Hutsons-Hacks](https://hutsons-hacks.info/histogram-with-auto-binning-in-ggplot2).\n",
    "supporting": [
      "histogram-with-auto-binning-in-ggplot2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}